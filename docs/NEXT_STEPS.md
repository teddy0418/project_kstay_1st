# KSTAY — 지금 완성하면 좋은 것들

전체 파악 후 정리 (결제 PG·사업자등록은 나중에 진행한다고 가정).

---

## 1. 이미 구현된 것

| 영역 | 내용 |
|------|------|
| **게스트 플로우** | 홈, 검색/브라우즈, 숙소 상세, 예약 위젯(날짜/인원), 체크아웃, 결제(MOCK·PortOne 연동 코드), 결제 완료/리다이렉트, 위시리스트, 프로필, 게시판, 메시지, 도움말 |
| **호스트 플로우** | 온보딩 → PENDING → 승인 후 대시보드, 숙소 등록 위저드(기본정보/위치/가격/편의시설/사진/리뷰), 예약·정산·캘린더·알림·계정 페이지(UI) |
| **관리자** | 승인(approvals), 정산(settlements) 페이지 |
| **인증** | NextAuth, 데모 로그인/모달, 로그아웃, Reserve 시 비로그인 → 로그인 모달 |
| **결제** | MOCK 모드 즉시 확정, PortOne 모드(예약 생성 → 결제창 모달 → 웹훅 확정), 결제 완료 시 이메일 발송(Resend) |
| **데이터** | Prisma + PostgreSQL, 예약/리뷰/위시리스트/숙소/이미지/호스트 상태 등 |
| **다국어·통화** | ko/ja/zh/en, 통화 전환, IP 기반 언어/통화 감지(geo) |
| **정책** | 게스트 12% 수수료, 호스트 0%, 7일 전 무료 취소(KST), 24시간 호스트 거절 |
| **예약된 날짜** | 결제 완료(CONFIRMED)만 달력에서 막힘 |

---

## 2. MVP/플레이스홀더로 남은 것

| 항목 | 현재 | 완성 시 기대 |
|------|------|----------------|
| **실제 OAuth** | 구글 로그인 버튼 → 데모 세션 생성 | Google Client ID/Secret 연결, 실제 계정 연동 |
| **이메일 로그인** | UI만, DB 저장 없음 | 이메일 인증·비밀번호 또는 매직링크 |
| **검색/필터** | 목록 전체 또는 ids 파라미터 | 키워드·지역·날짜·가격 필터, 실제 검색 API |
| **호스트 정산** | "정산 내역/출금 요청 영역 (MVP)" 문구만 | 정산 주기·출금 요청·입금 처리 플로우 |
| **호스트 알림** | "(MVP) 정산/예약/운영 알림 목록" 문구만 | 실시간/목록 알림 |
| **호스트 계정** | "(MVP) 파트너 정보/정산 계좌" 문구만 | 계좌 정보·세금 정보 입력 |
| **관리자 정산** | 페이지만 있음 | 실제 정산 배치·승인 플로우 |
| **리뷰** | DB 저장·목록 조회 있음, 상세 페이지에서 리뷰 작성 폼/API 연동 확인 필요 | 리뷰 작성 → 저장 → 노출 전부 연결 |
| **메시지** | 페이지 존재 | 게스트–호스트 메시지 함, 읽음/알림 |

---

## 3. 완성 우선순위 제안

**사업자등록·PG 심사 전에 해두면 좋은 것**

1. **리뷰 플로우**  
   - 숙소 상세에서 DB 리뷰 노출은 됨.  
   - **완성**: 예약 완료된 게스트만 리뷰 작성 가능하게 하고, 작성 폼 → `POST /api/reviews` → DB 저장 → 상세에 반영되는지 확인·보완.

2. **검색/브라우즈**  
   - 지금은 전체 목록 또는 ids.  
   - **완성**: 쿼리 파라미터(키워드, 지역, 체크인/아웃, 인원)로 필터링하는 API + 브라우즈/검색 UI 연결.

3. **실제 Google 로그인**  
   - NextAuth Google Provider는 이미 연결됨. **설정만 하면 됨**: Google Cloud Console에서 OAuth 클라이언트 생성 후 `.env.local`에 `GOOGLE_CLIENT_ID`, `GOOGLE_CLIENT_SECRET`, `NEXTAUTH_URL` 설정. 자세한 단계는 **docs/GOOGLE_LOGIN.md** 참고.

4. **리뷰/카테고리 UI**  
   - 이전에 말한 "Cleanliness, Check-in 등 라벨 잘림" 수정.  
   - 긴 라벨은 줄바꿈 또는 짧은 라벨로 표시해 가독성 개선.

5. **호스트·관리자**  
   - 정산/알림/계정은 “영역만 있는 MVP”이므로, 사업자등록·PG 이후에 정산 규칙 정하고 구현해도 됨.  
   - 우선은 **호스트 숙소 등록 → 승인 → 예약 받기** 플로우가 끊기지 않는지 점검.

**사업자등록·PG 이후**

- PortOne(또는 PG) 가맹점 승인 후 실제 결제 테스트.
- PayPay, Thai QR 등 추가 수단은 PG 계약·대시보드에서 활성화 후 연동.

---

## 4. 한 줄 요약

- **지금 할 것**: 리뷰 작성→저장→노출 연결, 검색/필터 API·UI, (선택) Google 로그인, 리뷰 카드 라벨 잘림 수정.  
- **나중에 할 것**: 사업자등록·PG 심사 → 실제 결제·정산, 호스트 정산/알림/계정 실기능.
