# 앞으로 해야 할 것들 — 브리핑

> **코드 기준**으로 확인해 정리했습니다. 예전 NEXT_STEPS.md와 혼동되지 않도록 완료/미완을 구분했습니다.

## 이미 완료된 것 (코드·연동 기준)

### 숙소등록·검토

| 항목 | 내용 |
|------|------|
| **숙소 등록 위저드** | 위치 → 가격 → 어메니티 → 사진 → 숙소정보 → 검토. 기본정보는 숙소정보에 통합. |
| **가격** | 평일 기본 요금, **인원 추가당 금액**, 주말/성수기 할증, 환불 불가 특가, 표준 환불 정책. |
| **어메니티** | 카테고리당 6개(총 24개), 스키마 검증으로 정의된 키만 저장. |
| **검토 단계** | 사진·서류(사업자등록증, 숙소 유형별 신고·지정증) 업로드, 승인요청(PENDING). |
| **예약 확정 메일** | 숙소정보(체크인/아웃 시간, 체크인 안내, 이용 규칙) + **위치(정확한 주소)** + 가격(총액) 포함. |
| **스토리지** | 서류 업로드: `DOCUMENT_STORAGE=local`(기본) 또는 `s3`(AWS_S3_BUCKET 등 설정 시). |
| **승인된 숙소 수정** | PATCH는 APPROVED일 때 체크인 안내·이용 규칙·상세 주소만 허용. `/host/listings/[id]/approved-edit` 페이지 있음. |

### 리뷰 (이미 완료)
| 항목 | 내용 |
|------|------|
| **리뷰 API** | `POST /api/reviews` — 예약 확정·체크아웃 후만, 예약당 1회. |
| **리뷰 작성** | 프로필 예약 내역에서 작성 폼 → API → DB 저장. |
| **리뷰 노출** | 숙소 상세에서 DB 리뷰 표시. |

### 검색/필터 (이미 완료)
| 항목 | 내용 |
|------|------|
| **필터 API** | `getPublicListings(filters)` — where(키워드), start/end(날짜·예약 가능). |
| **브라우즈** | `/browse`에서 searchParams.where, start, end로 필터 연동. |

### Google 로그인 (코드 완료)
- NextAuth Google Provider 연동됨. **환경변수만** 설정하면 동작 (`GOOGLE_CLIENT_ID`, `GOOGLE_CLIENT_SECRET`, `NEXTAUTH_URL`).

---

## 설정/환경만 하면 되는 것

- **Google 로그인**: `.env.local`에 위 3개 변수. (docs/GOOGLE_LOGIN.md)
- **S3 서류 (운영 시)**: `DOCUMENT_STORAGE=s3`, `AWS_S3_BUCKET`, `AWS_REGION`, 자격증명. (선택) `DOCUMENT_STORAGE_PUBLIC_BASE_URL`

---

## 실제로 남은/선택 작업

1. **리뷰 카드 UI** — (선택) Cleanliness, Check-in 등 라벨 잘림 수정.
2. **숙소 상세 리뷰 진입** — (선택) 지금은 프로필에서만 작성. 상세에 "이 숙소 리뷰 쓰기" 링크 추가 여부.
3. **인원 필터** — getPublicListings에 인원(guests) 필터 없음. 필요 시 추가.

---

## 중기(기능 보강)

| 항목 | 내용 |
|------|------|
| **호스트 정산** | 정산 주기·출금 요청·입금 처리 플로우 (PG/사업자등록 이후). |
| **호스트 알림** | 정산/예약/운영 알림 목록·실시간 알림. |
| **호스트 계정** | 파트너 정보·정산 계좌·세금 정보 입력. |
| **관리자 정산** | 실제 정산 배치·승인 플로우. |
| **메시지** | 게스트–호스트 메시지 함, 읽음/알림. |
| **숙소 설명 다국어** | hostBio 저장 시 기계 번역으로 hostBioJa, hostBioZh 등 저장 (선택). |

---

## 보안·운영

| 항목 | 권장 |
|------|------|
| **업로드 파일 검증** | MIME 외에 매직 바이트 검사, 실행 파일 확장자 차단. |
| **문서 URL 접근** | 관리자/호스트만 보게 하려면 인증 경로에서 스트리밍 또는 서명 URL. |
| **에러 처리** | `getPublicListingById` 등 mock fallback 범위 축소, 운영에서는 명시적 에러 응답·로깅. |

---

## 한 줄 요약

- **이미 완료**: 리뷰(API·프로필 작성·상세 노출), 검색/필터(where·날짜·브라우즈 연동), Google 로그인(코드 연동).
- **설정만**: Google env, S3 env(운영 시).
- **실제 남은 것**: 리뷰 카드 UI·상세 리뷰 진입(선택), 인원 필터(필요 시), 중기(정산/알림/계정/메시지 등).
- **보안**: 업로드 매직 바이트·문서 URL 접근 제어(선택).
